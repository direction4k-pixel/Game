<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-sky-100 to-indigo-200 min-h-screen flex items-center justify-center p-6 font-sans">
  <div class="w-full max-w-md bg-white rounded-3xl shadow-xl p-6">
    <h1 class="text-2xl font-bold text-center text-indigo-700 mb-4">ğŸ“ Ø§Ø³ØªÙ…Ø§Ø±Ø© ØªØ³Ø¬ÙŠÙ„</h1>

    <form id="signupForm" class="space-y-3">
      <div>
        <label class="block text-right text-sm font-medium mb-1">Ø§Ù„Ø§Ø³Ù…</label>
        <input id="name" type="text" required class="w-full p-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-indigo-300" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
      </div>

      <div>
        <label class="block text-right text-sm font-medium mb-1">Ø§Ù„Ù„Ù‚Ø¨</label>
        <input id="lastname" type="text" required class="w-full p-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-indigo-300" placeholder="Ø£Ø¯Ø®Ù„ Ù„Ù‚Ø¨Ùƒ">
      </div>

      <div>
        <label class="block text-right text-sm font-medium mb-1">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
        <input id="email" type="email" required class="w-full p-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-indigo-300" placeholder="you@example.com">
      </div>

      <div>
        <label class="block text-right text-sm font-medium mb-1">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</label>
        <input id="password" type="password" required minlength="4" class="w-full p-3 rounded-lg border border-gray-200 focus:ring-2 focus:ring-indigo-300" placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ø³Ø±">
      </div>

      <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 rounded-xl transition">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
    </form>

    <p id="msg" class="mt-4 text-center text-sm"></p>
  </div>

  <script>
    // Ø¶Ø¹ Ù‡Ù†Ø§ Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø°ÙŠ Ù†Ø´Ø±ØªÙ‡ (ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ù€ /exec)
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyoaiP1WzV_wH_vOh611Hqbl2GEtAPIQ3FcJEABj2Qkknc8v4FuhhatVIjvQm-5hlG7zg/exec";

    // Ø¥Ø°Ø§ ÙˆØ§Ø¬Ù‡Øª Ù…Ø´Ø§ÙƒÙ„ CORS Ø£Ø«Ù†Ø§Ø¡ ØªØ¬Ø±Ø¨Ø© Ù…Ø­Ù„ÙŠØ©ØŒ Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø¨Ø±ÙˆÙƒØ³ÙŠ Ù…Ø¤Ù‚Øª Ù‡Ù†Ø§ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
    // const PROXY = "https://cors-anywhere.herokuapp.com/"; // Ù…Ø¤Ù‚Øª ÙÙ‚Ø·
    const PROXY = "";

    const form = document.getElementById('signupForm');
    const msg = document.getElementById('msg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.className = 'mt-4 text-center text-gray-700';
      msg.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨...';

      const payload = {
        "Ø§Ù„Ø§Ø³Ù…": document.getElementById('name').value.trim(),
        "Ø§Ù„Ù„Ù‚Ø¨": document.getElementById('lastname').value.trim(),
        "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ": document.getElementById('email').value.trim(),
        "ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±": document.getElementById('password').value
      };

      // ØªØ­Ù‚Ù‚ Ø³Ø±ÙŠØ¹ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„
      if (!payload["Ø§Ù„Ø§Ø³Ù…"] || !payload["Ø§Ù„Ù„Ù‚Ø¨"] || !payload["Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"] || !payload["ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±"]) {
        msg.className = 'mt-4 text-center text-red-600';
        msg.textContent = 'âŒ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„.';
        return;
      }

      try {
        const res = await fetch((PROXY || '') + SCRIPT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
        });

        // Ø­Ø§ÙˆÙ„ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±Ø¯ Ø¥Ù„Ù‰ JSON Ø¥Ù† Ø£Ù…ÙƒÙ†
        let json;
        try {
          json = await res.json();
        } catch (err) {
          json = null;
        }

        if (json) {
          if (json.ok) {
            msg.className = 'mt-4 text-center text-green-600';
            msg.textContent = json.message || 'âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ÙƒØŒ Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.';
            form.reset();
          } else {
            msg.className = 'mt-4 text-center text-red-600';
            msg.textContent = json.message || json.error || 'âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.';
          }
        } else {
          // Ø¥Ø°Ø§ Ø§Ù„Ø±Ø¯ Ù„ÙŠØ³ JSON ÙˆÙ„ÙƒÙ† Ø§Ù„Ø­Ø§Ù„Ø© 200 ÙØ¥Ù†Ù‡ ØºØ§Ù„Ø¨Ù‹Ø§ ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
          if (res.ok) {
            msg.className = 'mt-4 text-center text-green-600';
            msg.textContent = 'âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ (Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© ØºÙŠØ± Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù‚Ø±Ø§Ø¡Ø©). ØªØ­Ù‚Ù‚ Ù…Ù† Google Sheet.';
            form.reset();
          } else {
            msg.className = 'mt-4 text-center text-red-600';
            msg.textContent = 'âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. Ø±Ù…Ø² Ø§Ù„Ø­Ø§Ù„Ø©: ' + res.status;
          }
        }
      } catch (err) {
        console.error(err);
        msg.className = 'mt-4 text-center text-red-600';
        msg.textContent = 'âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ø´Ø± Ø§Ù„Ø³ÙƒØ±Ø¨Øª ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ø§Ø¨Ø· /exec Ø§Ù„ØµØ­ÙŠØ­.';
      }
    });
  </script>
</body>
</html>
